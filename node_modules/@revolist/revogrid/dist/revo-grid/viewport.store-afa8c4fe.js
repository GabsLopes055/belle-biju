/*!
 * Built by Revolist OU ❤️
 */
import{j as t,W as e,w as i}from"./dimension.helpers-d0d709c4.js";const s=10;const n=(t,e,i=50)=>(e===null||e===void 0?void 0:e.size)||Math.max((t.toString().length+1)*s,i);function r(e,i,s,n,r){const u=t(r,e);const d=m(i);let h;if(d){let t=u.itemIndex-(d.itemIndex||0);if(t){h=l(Math.abs(t),Object.assign(Object.assign({positiveDirection:t>-1},r),i))}}const b=o(n,r.realSize,u);if(h){const t=a(u,s,b,h,r);if(t.length){c(h.items,t,h)}}if(!h){const t=f({firstItemStart:u.start,firstItemIndex:u.itemIndex,origSize:r.originItemSize,maxSize:b,maxCount:s,sizes:r.sizes});h={items:t,start:0,end:t.length-1}}return h}function o(t,e,i){return Math.min(t+(i.end-i.start),e)}function c(t,e,i){t.splice(i.end+1,0,...e);if(i.start>=i.end&&!(i.start===i.end&&i.start===0)){i.start+=e.length}i.end+=e.length}function a(t,e,i,s,n){const r=b(s);const o=f({sizes:n.sizes,firstItemStart:r.end,firstItemIndex:r.itemIndex+1,origSize:n.originItemSize,maxSize:i-(r.end-t.start),maxCount:e});return o}function f(t,e=0){const i=[];let s=t.firstItemIndex;let n=e;while(n<=t.maxSize&&s<t.maxCount){const e=u(s,t.sizes,t.origSize);i.push({start:t.firstItemStart+n,end:t.firstItemStart+n+e,itemIndex:s,size:e});n+=e;s++}return i}function l(t,e){var i,s;const n=[...e.items];const r=n.length;let o={start:e.start,end:e.end};if(t>r){return undefined}if(e.positiveDirection){let i=b(e);let s=o.start;const c=s+t;for(;s<c;s++){const t=i.itemIndex+1;const c=u(t,e.sizes,e.originItemSize);if(i.end+c>e.realSize){break}let a=s%r;if(!n[a]){throw new Error("incorrect index")}n[a]=i={start:i.end,end:i.end+c,itemIndex:t,size:c};o.start++;o.end=a}}else{let c=m(e);const a=o.end;for(let f=0;f<t;f++){const t=((i=c===null||c===void 0?void 0:c.itemIndex)!==null&&i!==void 0?i:0)-1;const l=u(t,e.sizes,e.originItemSize);let d=a-f;d=(d<0?r+d:d)%r;if(!n[d]){console.error("incorrect index");break}const h=(s=c===null||c===void 0?void 0:c.start)!==null&&s!==void 0?s:0;n[d]=c={start:h-l,end:h,itemIndex:t,size:l};o.start=d;o.end--}}const c={start:(o.start<0?r+o.start:o.start)%r,end:(o.end<0?r+o.end:o.end)%r};return Object.assign({items:n},c)}function u(t,e,i=0){if(e&&e[t]){return e[t]}return i}function d(t,e,i,s){if(!i||!s){return false}return t>=i.start&&t<=i.end||t>i.end&&s.end===e}function h(t,e,i,s){var n;if(!i){return false}return e+t>((n=s===null||s===void 0?void 0:s.end)!==null&&n!==void 0?n:0)}function m(t){return t.items[t.start]}function b(t){return t.items[t.end]}function v(t,e,i,s){const n=[...t];const r=n.length;let o=s;let c=0;let a=e;if(!r){return[]}while(c<r){const t=n[a];t.start=o;t.size=i;t.end=t.start+i;o=t.end;a++;c++;if(a===r){a=0}}return n}function z(){return{items:[],start:0,end:0,virtualSize:0,realCount:0,clientSize:0}}class j{get lastCoordinate(){return this.lastKnownScroll}set lastCoordinate(t){this.lastKnownScroll=t}constructor(t){this.type=t;this.lastKnownScroll=0;this.store=e(z())}setViewPortCoordinate(t,e,i=false){const s=this.store.get("virtualSize");if(!s){return}const n=1;const o=e.originItemSize*n;const f=o*2;const l=s+f;let u=0;if(e.realSize>s){u=e.realSize-s-o}let v=t;if(v<0){v=0}else if(v>u){v=u}this.lastCoordinate=v;v-=o;v=v<0?0:v<u?v:u;let z;if(i){z={items:[],start:0,end:0}}else{z=this.getItems()}const j=m(z);const O=b(z);let x={};if(!d(v,e.realSize,j,O)){x=Object.assign(Object.assign({},x),r(v,z,this.store.get("realCount"),l,e));this.setViewport(Object.assign({},x))}else if(h(v,l,j,O)){const t=[...z.items];const i=a(j,this.store.get("realCount"),l+v-j.start,z,{sizes:e.sizes,originItemSize:e.originItemSize});if(i.length){const e={start:this.store.get("start"),end:this.store.get("end")};c(t,i,e);x=Object.assign(Object.assign(Object.assign({},x),{items:[...t]}),e);this.setViewport(Object.assign({},x))}}}setOriginalSizes(t){const e=this.store.get("items");const s=e.length;if(!s){return}i(this.store,{items:v(e,this.store.get("start"),t,this.lastCoordinate)})}getItems(){return{items:this.store.get("items"),start:this.store.get("start"),end:this.store.get("end")}}setViewport(t){if(typeof t.realCount==="number"||typeof t.virtualSize==="number"){t=Object.assign(Object.assign({},t),{items:t.items||[]})}i(this.store,t)}}export{j as V,a,f as b,h as c,m as d,b as e,n as f,r as g,d as i,l as r,v as s,c as u};
//# sourceMappingURL=viewport.store-afa8c4fe.js.map